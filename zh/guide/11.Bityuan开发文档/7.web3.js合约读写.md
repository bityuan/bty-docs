# web3.jsåˆçº¦è¯»å†™

> ğŸ“¹ [è§†é¢‘æ•™ç¨‹](https://www.bilibili.com/video/BV1Lo4y1r7Sb/?share_source=copy_web&vd_source=6dc648c02f2bdc5a6e650dadc1136eed)

## 1. å‘åˆçº¦å†…å†™å…¥æ•°æ®

### é€šè¯mint

mintå‡½æ•°è°ƒç”¨æµç¨‹  

```javascript
// 1. è¯»å–ABIæ–‡ä»¶
var abi = JSON.parse(fs.readFileSync(path.join(__dirname, "../contract.abi")).toString())

// 2. providerè¿æ¥
var web3 = new Web3(new Web3.providers.HttpProvider("http://172.22.16.19:8545"));

// 3. è·å¾—åˆçº¦åœ°å€
var contractAddress = 'åˆçº¦åœ°å€';

// 4. åˆ›å»ºåˆçº¦instance
var tx = new web3.eth.Contract(abi, contractAddress);

// 5. mintæ“ä½œ
var mintTx = tx.methods.mint(tokenId, supply, uri);
const mint = async () => {
  const createTransaction = await web3.eth.accounts.signTransaction(
    {
      to: contractAddress,
      data: mintTx.encodeABI(),
      gas: await mintTx.estimateGas({from: "æ¥æºæ–¹åœ°å€"}),
    },
    "æ¥æºæ–¹ç§é’¥"
  );
  const createReceipt = await web3.eth.sendSignedTransaction(createTransaction.rawTransaction);
  console.log(createReceipt);
};
mint();
```

mintå‡½æ•°å¹¶ä¼ å…¥ä»¥ä¸‹ä¸‰ä¸ªå‚æ•°(tokenId: é€šè¯çš„ç¼–å·ï¼Œç”¨æ•´æ•°è¡¨ç¤º; supply: é€šè¯çš„ä¾›åº”é‡ï¼Œæ•´æ•°; uri: é€šè¯å…ƒæ•°æ®ä¿¡æ¯ï¼‰ã€‚ å…¶ä¸­uriä»£è¡¨é€šè¯å…ƒæ•°æ®ä¿¡æ¯ï¼Œå®ƒçš„æ ‡å‡†å‚è€ƒï¼š https://eips.ethereum.org/EIPS/eip-1155#metadata, ä»¥ä¸‹æ˜¯ä¸€ä¸ªuriç¤ºä¾‹ï¼Œä½†å®é™…çš„URIæ ¼å¼å„æœ‰åŒºåˆ«ï¼Œå…·ä½“å–å†³äºé€šè¯å‘è¡Œè€…çš„éœ€æ±‚ã€‚ 

```json
{
  "name": "MyToken",
  "description": "My custom ERC1155 token",
  "image": "https://example.com/token-image.png",
  "external_url": "https://example.com/token",
  "attributes": [
    {
      "trait_type": "color",
      "value": "blue"
    },
    {
      "trait_type": "size",
      "value": "medium"
    }
  ]
}
```

### é€šè¯tranfer

- é€šè¿‡åˆçº¦å®ä¾‹ä½¿ç”¨methods.safeTransferFromå‡½æ•°å¹¶ä¼ å…¥å‚æ•°(from: é€šè¯æ¥æºæ–¹åœ°å€; to: é€šè¯å»å‘æ–¹åœ°å€: id: é€šè¯ID, amount: è¦è½¬ç§»çš„é€šè¯æ•°é‡)æ¥ç”Ÿæˆè½¬ç§»é€šè¯çš„äº¤æ˜“
- å†é€šè¿‡fromåœ°å€çš„ç§é’¥ï¼Œç­¾åä¸Šè¿°äº¤æ˜“å¹¶å‘é€åˆ°é“¾ä¸Šï¼Œå®ç°é€šè¯è½¬ç§»

transferå‡½æ•°è°ƒç”¨æµç¨‹  
```javascript
// è½¬è´¦æ“ä½œ
var transferTx = tx.methods.safeTransferFrom("æ¥æºåœ°å€", "å»å‘åœ°å€", é€šè¯ID, è½¬è®©æ•°é‡, "0x");

const transfer = async () => {

  const transferTransaction = await web3.eth.accounts.signTransaction(
    {
      to: contractAddress,
      data: transferTx.encodeABI(),
      gas: await transferTx.estimateGas({from: "æ¥æºåœ°å€"}),
    },
    "æ¥æºåœ°å€é’¥"
  );

  const createReceipt = await web3.eth.sendSignedTransaction(transferTransaction.rawTransaction);
};
transfer();
```

## 2. åˆçº¦ä¿¡æ¯æŸ¥è¯¢

```javascript
// æŸ¥è¯¢æ“ä½œ
const getInfo = async () => {
  // æŸ¥è¯¢fromåœ°å€ä¸‹çš„ä½™é¢
  const fromValue = await tx.methods.balanceOf("åœ°å€", é€šè¯ID).call();
  console.log(`The current balance of from is: ${fromValue}`);

  // æŸ¥è¯¢toåœ°å€ä¸‹çš„ä½™é¢
  const toValue = await tx.methods.balanceOf("åœ°å€", é€šè¯ID).call();
  console.log(`The current balance of to: ${toValue}`);

  // æŸ¥è¯¢URIä¿¡æ¯
  const uri = await tx.methods.uri(tokenId).call();
  console.log(`The current balance of to: ${uri}`);
};
getInfo();
```

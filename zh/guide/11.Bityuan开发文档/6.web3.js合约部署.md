# web3.jsåˆçº¦éƒ¨ç½²

> ğŸ“¹ [è§†é¢‘æ•™ç¨‹](https://www.bilibili.com/video/BV1x24y1H7zj/?share_source=copy_web)

## 1. åˆçº¦ç¼–å†™

- ç¼–å†™ä¸€ä¸ªERC1155çš„æ™ºèƒ½åˆçº¦ï¼Œç»§æ‰¿äº†OpenZeppelin ERC1155å’ŒOwnableåˆçº¦
- åˆçº¦ä¸­æœ‰ä¸¤ä¸ªç§æœ‰æ˜ å°„å˜é‡ _tokenSupply å’Œ _tokenURIsï¼Œåˆ†åˆ«ç”¨äºå­˜å‚¨æ¯ä¸ªERC1155ä»£å¸çš„ä¾›åº”é‡å’ŒURI
- åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œä¼ å…¥äº†åŸºç¡€URIï¼Œç”¨äºç¡®å®šä»£å¸çš„å…ƒæ•°æ®
- mint å‡½æ•°å¯ä¾›æ‰€æœ‰è€…è°ƒç”¨æ¥é“¸é€ æ–°çš„ERC1155ä»£å¸ã€‚è¯¥å‡½æ•°è°ƒç”¨äº† _mint å‡½æ•°å°†æ–°ä»£å¸çš„ä¾›åº”é‡æ·»åŠ åˆ°ç‰¹å®šå¸æˆ·ä¸­
- _tokenSupply å’Œ _tokenURIs æ˜ å°„éƒ½ä¼šæ›´æ–°ï¼Œå¹¶è§¦å‘ TokenMinted äº‹ä»¶ã€‚ è¯¥äº‹ä»¶è®°å½•äº†ä»£å¸ IDï¼Œä»£å¸ä¾›åº”é‡å’Œä»£å¸ URIã€‚tokenId å‚æ•°ä½¿ç”¨ indexed ä¿®é¥°ç¬¦è¿›è¡Œæ ‡è®°ï¼Œä»¥ä¾¿åœ¨äº‹ä»¶æ—¥å¿—ä¸­å¯ä»¥æ›´å¿«é€Ÿåœ°æœç´¢å¹¶è®¿é—®è¯¥å‚æ•°ã€‚ 

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v4.3.0/contracts/token/ERC1155/ERC1155.sol";
import "https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v4.3.0/contracts/access/Ownable.sol";

contract MyERC1155 is ERC1155, Ownable {

    mapping(uint256 => uint256) private _tokenSupply;
    mapping(uint256 => string) private _tokenURIs;

    event TokenMinted(uint256 indexed tokenId, uint256 supply, string uri);

    constructor(string memory uri) ERC1155(uri) {}

    function mint(uint256 tokenId, uint256 supply, string memory uri) public onlyOwner {
        _mint(msg.sender, tokenId, supply, "");
        _tokenSupply[tokenId] += supply;
        _tokenURIs[tokenId] = uri;
        emit TokenMinted(tokenId, supply, uri);
    }

    function tokenSupply(uint256 tokenId) public view returns (uint256) {
        return _tokenSupply[tokenId];
    }

    function uri(uint256 tokenId) public view override returns (string memory) {
        return _tokenURIs[tokenId];
    }
}
```

## 2. åˆçº¦ç¼–è¯‘

ç¼–è¯‘å·¥å…·: 
- [åœ¨çº¿remix](https://remix.ethereum.org/)
- solcå·¥å…·

ç¼–è¯‘ç»“æœ
- å­—èŠ‚ç (bytecode): æ˜¯solidityä»£ç è¢«ç¿»è¯‘ä»¥åçš„ä¿¡æ¯ï¼ŒåŒ…å«äº†äºŒè¿›åˆ¶çš„è®¡ç®—æœºæŒ‡ä»¤ã€‚
- ABI: åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ¥å£,ä»¥jsonæ–‡ä»¶è¡¨ç¤ºã€‚

## 3. åˆçº¦éƒ¨ç½²

å¯ä»¥æŸ¥çœ‹æ­¤ç›®å½•ä¸‹çš„å®Œæ•´è„šæœ¬ï¼š L6_sample.js  
æ¶‰åŠåˆ°çš„æ¥å£:
- eth.web3.estimateGas({"from address"}): ä¼°ç®—äº¤æ˜“çš„GASè´¹, from addressæ˜¯å¿…é¡»çš„å‚æ•°
- web3.eth.Contract(abi): è‡ªåŠ¨å°†æ‰€æœ‰çš„è°ƒç”¨è½¬æ¢ä¸ºåŸºäº RPC çš„åº•å±‚ ABI è°ƒç”¨ 
- web3.eth.accounts.signTransaction: æœ¬åœ°ç­¾åäº¤æ˜“
- web3.eth.sendSignedTransaction: å‘é€äº¤æ˜“

(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{607:function(s,n,a){"use strict";a.r(n);var t=a(1),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"web3-js-合约读写"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web3-js-合约读写"}},[s._v("#")]),s._v(" web3.js 合约读写")]),s._v(" "),a("h3",{attrs:{id:"_1-向合约内写入数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-向合约内写入数据"}},[s._v("#")]),s._v(" 1. 向合约内写入数据")]),s._v(" "),a("h4",{attrs:{id:"通证-mint"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通证-mint"}},[s._v("#")]),s._v(" 通证 mint")]),s._v(" "),a("p",[s._v("mint 函数调用流程")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('// 1. 读取ABI文件\nvar abi = JSON.parse(fs.readFileSync(path.join(__dirname, "../contract.abi")).toString())\n\n// 2. provider连接\nvar web3 = new Web3(new Web3.providers.HttpProvider("http://172.22.16.19:8545"));\n\n// 3. 获得合约地址\nvar contractAddress = \'合约地址\';\n\n// 4. 创建合约instance\nvar tx = new web3.eth.Contract(abi, contractAddress);\n\n// 5. mint操作\nvar mintTx = tx.methods.mint(tokenId, supply, uri);\nconst mint = async () => {\n  const createTransaction = await web3.eth.accounts.signTransaction(\n    {\n      to: contractAddress,\n      data: mintTx.encodeABI(),\n      gas: await mintTx.estimateGas({from: "来源方地址"}),\n    },\n    "来源方私钥"\n  );\n  const createReceipt = await web3.eth.sendSignedTransaction(createTransaction.rawTransaction);\n  console.log(createReceipt);\n};\nmint();\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("p",[s._v("mint 函数并传入以下三个参数（tokenId: 通证的编号，用整数表示; supply: 通证的供应量，整数; uri: 通证元数据信息）。 其中 uri 代表通证元数据信息，它的标准参考： https://eips.ethereum.org/EIPS/eip-1155#metadata, 以下是一个 uri 示例，但实际的 URI 格式各有区别，具体取决于通证发行者的需求。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('{\n  "name": "MyToken",  -- 通证名称\n  "description": "My custom ERC1155 token",  -- 通证的描述\n  "image": "https://example.com/token-image.png",  -- 通证图像的URL\n  "external_url": "https://example.com/token",  -- 指向通证相关网站的URL，没有的话，这个字段可以删除\n  "attributes": [                               -- 通证的属性数组\n    {\n      "trait_type": "color",  -- 属性的类型\n      "value": "blue"         -- 属性的值\n    },\n    {\n      "trait_type": "size",\n      "value": "medium"\n    }\n  ]\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("h4",{attrs:{id:"通证-tranfer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通证-tranfer"}},[s._v("#")]),s._v(" 通证 tranfer")]),s._v(" "),a("ul",[a("li",[s._v("通过合约实例使用 methods.safeTransferFrom 函数并传入参数(from: 通证来源方地址; to: 通证去向方地址: id: 通证 ID, amount: 要转移的通证数量)来生成转移通证的交易")]),s._v(" "),a("li",[s._v("再通过 from 地址的私钥，签名上述交易并发送到链上，实现通证转移")])]),s._v(" "),a("p",[s._v("transfer 函数调用流程")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('// 转账操作\nvar transferTx = tx.methods.safeTransferFrom("来源地址", "去向地址", 通证ID, 转让数量, "0x");\n\nconst transfer = async () => {\n\n  const transferTransaction = await web3.eth.accounts.signTransaction(\n    {\n      to: contractAddress,\n      data: transferTx.encodeABI(),\n      gas: await transferTx.estimateGas({from: "来源地址"}),\n    },\n    "来源地址钥"\n  );\n\n  const createReceipt = await web3.eth.sendSignedTransaction(transferTransaction.rawTransaction);\n};\ntransfer();\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h3",{attrs:{id:"_2-合约信息查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-合约信息查询"}},[s._v("#")]),s._v(" 2. 合约信息查询")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('// 查询操作\nconst getInfo = async () => {\n  // 查询from地址下的余额\n  const fromValue = await tx.methods.balanceOf("地址", 通证ID).call();\n  console.log(`The current balance of from is: ${fromValue}`);\n\n  // 查询to地址下的余额\n  const toValue = await tx.methods.balanceOf("地址", 通证ID).call();\n  console.log(`The current balance of to: ${toValue}`);\n\n  // 查询URI信息\n  const uri = await tx.methods.uri(tokenId).call();\n  console.log(`The current balance of to: ${uri}`);\n};\ngetInfo();\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);